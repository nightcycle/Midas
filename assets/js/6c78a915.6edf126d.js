"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4],{3905:(e,t,a)=>{a.d(t,{Zo:()=>h,kt:()=>p});var o=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,o,n=function(e,t){if(null==e)return{};var a,o,n={},r=Object.keys(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)a=r[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var s=o.createContext({}),u=function(e){var t=o.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},h=function(e){var t=u(e.components);return o.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,s=e.parentName,h=l(e,["components","mdxType","originalType","parentName"]),c=u(a),p=n,y=c["".concat(s,".").concat(p)]||c[p]||d[p]||r;return a?o.createElement(y,i(i({ref:t},h),{},{components:a})):o.createElement(y,i({ref:t},h))}));function p(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,i=new Array(r);i[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var u=2;u<r;u++)i[u]=a[u];return o.createElement.apply(null,i)}return o.createElement.apply(null,a)}c.displayName="MDXCreateElement"},90180:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>u});var o=a(87462),n=(a(67294),a(3905));const r={sidebar_position:3},i="PlayFab",l={unversionedId:"Integration/PlayFab",id:"Integration/PlayFab",title:"PlayFab",description:"In favor of producing a more accessible framework that doesn't require 3 hours of debugging cloud APIs for each user, we've gone with a more low-tech manual method for retrieving data from PlayFab. The basic plan is that we'll be running a KQL script in the PlayFab data explorer, then exporting the data as a CSV.",source:"@site/docs/Integration/PlayFab.md",sourceDirName:"Integration",slug:"/Integration/PlayFab",permalink:"/midas/docs/Integration/PlayFab",draft:!1,editUrl:"https://github.com/nightcycle/midas/edit/master/docs/Integration/PlayFab.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"defaultSidebar",previous:{title:"Roblox",permalink:"/midas/docs/Integration/Roblox"},next:{title:"Power BI",permalink:"/midas/docs/Integration/PowerBi"}},s={},u=[{value:"Why PlayFab?",id:"why-playfab",level:2},{value:"I don&#39;t want to use PlayFab",id:"i-dont-want-to-use-playfab",level:2},{value:"Retrieving the Data via PlayFab",id:"retrieving-the-data-via-playfab",level:2},{value:"Troubleshooting PlayFab",id:"troubleshooting-playfab",level:2},{value:"Your Authentication Expired",id:"your-authentication-expired",level:3},{value:"The Code Isn&#39;t Selected",id:"the-code-isnt-selected",level:3},{value:"Query Is Too Big",id:"query-is-too-big",level:3},{value:"Can I Automate This?",id:"can-i-automate-this",level:2}],h={toc:u};function d(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,o.Z)({},h,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"playfab"},"PlayFab"),(0,n.kt)("p",null,"In favor of producing a more accessible framework that doesn't require 3 hours of debugging cloud APIs for each user, we've gone with a more low-tech manual method for retrieving data from PlayFab. The basic plan is that we'll be running a KQL script in the PlayFab data explorer, then exporting the data as a CSV."),(0,n.kt)("h2",{id:"why-playfab"},"Why PlayFab?"),(0,n.kt)("p",null,"The online service PlayFab will allow you ",(0,n.kt)("a",{parentName:"p",href:"https://playfab.com/pricing/"},"100,000 users worth of data-storage for free per game"),". You're welcome to shop-around for better options, but it is in my experience more than adequate for kickstarting a new game. If you have an established game with larger a larger audience, they offer a pay-as-you-go option, and at $99 a month the amount of players that can be stored becomes unlimited."),(0,n.kt)("h2",{id:"i-dont-want-to-use-playfab"},"I don't want to use PlayFab"),(0,n.kt)("p",null,"Alright, all you technicall need is a CSV of data that meets this format:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-csv"},'"DATA","TIMESTAMP","VERSION","VERSION_TEXT","EVENT_ID"\n')),(0,n.kt)("p",null,"The header order doesn't matter. Here's what needs to be under each column"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},'DATA: This should be an encoded JSON table provided in the body of the API post request at "State"'),(0,n.kt)("li",{parentName:"ul"},'TIMESTAMP: A string that can be parsed into a DateTime object. For example: "2022-09-28T21:53:49.859Z"'),(0,n.kt)("li",{parentName:"ul"},"VERSION: An encoded JSON table provided within the DATA JSON table."),(0,n.kt)("li",{parentName:"ul"},'VERSION_TEXT: A readable version string provided at key "Version" in the API post request.'),(0,n.kt)("li",{parentName:"ul"},"EVENT_ID: A 32 character string that is unique for each event.")),(0,n.kt)("p",null,"So long as whatever your method in results in a CSV file that fits the above conditions, you do not need to use PlayFab to use this Framework. If there is enough demand for a separate workflow that does this for you (for example, with GameAnalytics), I am not against adding it, I'm just unmotivated at this time."),(0,n.kt)("h2",{id:"retrieving-the-data-via-playfab"},"Retrieving the Data via PlayFab"),(0,n.kt)("p",null,"This is how you can get your data out of PlayFab after it's been recorded.If you haven't already, first ",(0,n.kt)("a",{parentName:"p",href:"https://doc.photonengine.com/en-us/bolt/current/demos-and-tutorials/playfab-integration/playfab-101-setup-game-title#:~:text=Login%20or%20create%20a%20new,to%20the%20Game%20Title%20dashboard."},'create an account and a "Title" entity for your game'),'. After completing that, go into your new Title\'s profile and on the menu on the left side at the very bottom click the "Data" button under the "Analyze" category. Once you\'ve done that you will now be looking at the "Data Explorer (basic)". At the top of the page is a tab for "Data Explorer (advanced)". Click that tab, and you\'ll be taken to one of the most cluttered and temperamental code editing UX I have ever used. '),(0,n.kt)("p",null,"This is the KQL editor, and you can use it to run KQL code which will output data at the bottom. First, copy the text in the ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/nightcycle/midas/blob/main/scripts/export.kql"},"export.kql")," file. The way this code works, is it starts by finding players who were recorded in your game between the TIME_RANGE_START and TIME_RANGE_END variables. It then searches the entire database for all events relating to those users. This is so that the user profiles are accurate - if a person played your game 100 times in the last year, but only 1 time in the time range, you'll want to know that. As a bonus, this also easily allows you to compare how a current version of the game is performing against a previous version. You may also set a PLAYER_COUNT limit, this will arbitrarily limit the amount of users recorded."),(0,n.kt)("p",null,'Once you\'ve pasted and configured the KQL code into the PlayFab editor, press "Run" in the upper left hand corner of the editor. If it runs correctly you should see a table appear at the bottom. If you do, select the dropdown menu labeled "File" in the upper right side of the editor, and press the option "Export to CSV". This will download the data to your computer.'),(0,n.kt)("h2",{id:"troubleshooting-playfab"},"Troubleshooting PlayFab"),(0,n.kt)("p",null,'The less you have the troubleshoot PlayFab the happier you will be. Most of the errors tell you "An Error Occurrred" and nothing else. Here are some potential reasons an error could have occurred.'),(0,n.kt)("h3",{id:"your-authentication-expired"},"Your Authentication Expired"),(0,n.kt)("p",null,"So, for whatever reason sometimes if I keep a PlayFab tab open for a few hours, when I run a query - even a very simple one, it errors. I'm still logged in, but I guess some internal authentication key needs to be updated. To fix this, just refresh the page and try again. Don't trust the editor to save your code though - I almost always write it in VSCode then copy it over because of this."),(0,n.kt)("h3",{id:"the-code-isnt-selected"},"The Code Isn't Selected"),(0,n.kt)("p",null,"You didn't select the code you wanted to run. In KQL the entire query needs to be a single block of text (though you can connect things with comments if this is too annoying). It will be slightly highlighted if it's selected. Also, the selection detection is not bulletproof, feel free to click the code again and retry. KQL is one of the few languages where just running the code again can fix the problem. "),(0,n.kt)("h3",{id:"query-is-too-big"},"Query Is Too Big"),(0,n.kt)("p",null,"Many users, especially those with established games, will not be able to export all their data at once. Depending on the amount you store + the number of events per session, you can usually get around 500-2000 sessions of data in a single go. This is why the KQL script I provided has a start / end time variable. If your data is too big, I recommend downloading it in chunks. You can import as many CSVs as you want into the upcoming Power Bi step - all you need to do is put them under the same folder, you don't even need to name them anything. The python script ahead will deduplicate the data as needed."),(0,n.kt)("h2",{id:"can-i-automate-this"},"Can I Automate This?"),(0,n.kt)("p",null,"Yes you can. It will require you to create an AAD account in your microsoft workspace, and then using its credentials to perform API calls to retrieve the data. From there you can manually write it into a CSV or bypass the CSV step entirely and modify the upcoming Python script to work with the data you've retrieved. This is a process that took me hours to get right, and whenever I had to set up a new project it would take another hour because I'd forget. Automation is possible, but I'm not sure it's worth it for most devs."),(0,n.kt)("p",null,"Doing it manually takes around 3-5 boring minutes. You don't have to worry about rate limits. And you only have to do this once per update. The goal of Midas is not to provide a live feed of how your game is doing, it's meant to allow you to do an in-depth study into how an update has influenced the player experiences in your game. I have gone through this process over a dozen times, and frankly all trying to automate it seems to accomplish for me is headaches."))}d.isMDXComponent=!0}}]);